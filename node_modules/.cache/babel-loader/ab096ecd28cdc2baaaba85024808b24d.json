{"ast":null,"code":"import _asyncToGenerator from\"E:/COURSE/REACT_JS_n_PWA/crud/retail/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"E:/COURSE/REACT_JS_n_PWA/crud/retail/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"E:\\\\COURSE\\\\REACT_JS_n_PWA\\\\crud\\\\retail\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import axios from\"axios\";import React,{useEffect,useState}from\"react\";import Table from\"../Table/Table\";import{openDB,deleteDB,wrap,unwrap}from\"idb\";import{jsx as _jsx}from\"react/jsx-runtime\";var List=function List(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),list=_useState2[0],setlist=_useState2[1];useEffect(function(){openDB(\"retail_list\",1,{upgrade:function upgrade(db){db.createObjectStore(\"list_data\",{keyPath:\"retail_id\"});}});},[]);useEffect(function(){var get_data_mysql=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var db;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return openDB(\"retail_list\",1);case 2:db=_context4.sent;axios.get(\"https://django-retail-app.herokuapp.com/retail/create/\").then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(response){var retail_data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setlist(response.data);retail_data=response.data;db.clear(\"list_data\");retail_data.map(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(info){var mysql_data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(info.email);mysql_data={retail_id:info.retail_id,name:info.name,email:info.email,contact_number1:info.contact_number1,contact_number2:info.contact_number2,retail_size:info.retail_size,it_automation:info.it_automation,no_of_mobile:info.no_of_mobile,no_of_tab:info.no_of_tab,no_of_computer:info.no_of_computer,no_of_printer:info.no_of_printer,no_of_scanner:info.no_of_scanner,latitude:info.latitude,longitude:info.longitude,date_time:info.date_time,image:info.image};_context.next=4;return db.get(\"list_data\",info.retail_id);case 4:if(_context.sent){_context.next=6;break;}db.add(\"list_data\",mysql_data).then(function(res){console.log(res);});case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x2){return _ref3.apply(this,arguments);};}());case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}()).catch(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(err){var data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(err);if(!(err.message==\"Network Error\")){_context3.next=6;break;}_context3.next=4;return db.getAll(\"list_data\");case 4:data=_context3.sent;setlist(data);case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref4.apply(this,arguments);};}());case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function get_data_mysql(){return _ref.apply(this,arguments);};}();get_data_mysql();},[]);return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Table,{list:list})});};export default List;","map":{"version":3,"names":["axios","React","useEffect","useState","Table","openDB","deleteDB","wrap","unwrap","List","list","setlist","upgrade","db","createObjectStore","keyPath","get_data_mysql","get","then","response","data","retail_data","clear","map","info","console","log","email","mysql_data","retail_id","name","contact_number1","contact_number2","retail_size","it_automation","no_of_mobile","no_of_tab","no_of_computer","no_of_printer","no_of_scanner","latitude","longitude","date_time","image","add","res","catch","err","message","getAll"],"sources":["E:/COURSE/REACT_JS_n_PWA/crud/retail/src/components/RetailList/List.js"],"sourcesContent":["import axios from \"axios\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport Table from \"../Table/Table\";\r\nimport { openDB, deleteDB, wrap, unwrap } from \"idb\";\r\n\r\nconst List = () => {\r\n  const [list, setlist] = useState([]);\r\n  useEffect(() => {\r\n    openDB(\"retail_list\", 1, {\r\n      upgrade(db) {\r\n        db.createObjectStore(\"list_data\", { keyPath: \"retail_id\" });\r\n      },\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const get_data_mysql = async () => {\r\n      const db = await openDB(\"retail_list\", 1);\r\n      axios\r\n        .get(\"https://django-retail-app.herokuapp.com/retail/create/\")\r\n        .then(async (response) => {\r\n          setlist(response.data);\r\n\r\n          const retail_data = response.data;\r\n          db.clear(\"list_data\");\r\n\r\n          retail_data.map(async (info) => {\r\n            console.log(info.email);\r\n            const mysql_data = {\r\n              retail_id: info.retail_id,\r\n              name: info.name,\r\n              email: info.email,\r\n              contact_number1: info.contact_number1,\r\n              contact_number2: info.contact_number2,\r\n              retail_size: info.retail_size,\r\n              it_automation: info.it_automation,\r\n              no_of_mobile: info.no_of_mobile,\r\n              no_of_tab: info.no_of_tab,\r\n              no_of_computer: info.no_of_computer,\r\n              no_of_printer: info.no_of_printer,\r\n              no_of_scanner: info.no_of_scanner,\r\n              latitude: info.latitude,\r\n              longitude: info.longitude,\r\n              date_time: info.date_time,\r\n              image: info.image,\r\n            };\r\n\r\n            if (!(await db.get(\"list_data\", info.retail_id))) {\r\n              db.add(\"list_data\", mysql_data).then((res) => {\r\n                console.log(res);\r\n              });\r\n            }\r\n          });\r\n        })\r\n        .catch(async (err) => {\r\n          console.log(err);\r\n          if (err.message == \"Network Error\") {\r\n            const data = await db.getAll(\"list_data\");\r\n            setlist(data);\r\n          }\r\n        });\r\n    };\r\n    get_data_mysql();\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <Table list={list} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default List;\r\n"],"mappings":"0XAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,KAAP,KAAkB,gBAAlB,CACA,OAASC,MAAT,CAAiBC,QAAjB,CAA2BC,IAA3B,CAAiCC,MAAjC,KAA+C,KAA/C,C,2CAEA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,EAAM,CACjB,cAAwBN,QAAQ,CAAC,EAAD,CAAhC,wCAAOO,IAAP,eAAaC,OAAb,eACAT,SAAS,CAAC,UAAM,CACdG,MAAM,CAAC,aAAD,CAAgB,CAAhB,CAAmB,CACvBO,OADuB,kBACfC,EADe,CACX,CACVA,EAAE,CAACC,iBAAH,CAAqB,WAArB,CAAkC,CAAEC,OAAO,CAAE,WAAX,CAAlC,EACD,CAHsB,CAAnB,CAAN,CAKD,CANQ,CAMN,EANM,CAAT,CAQAb,SAAS,CAAC,UAAM,CACd,GAAMc,CAAAA,cAAc,0FAAG,sKACJX,CAAAA,MAAM,CAAC,aAAD,CAAgB,CAAhB,CADF,QACfQ,EADe,gBAErBb,KAAK,CACFiB,GADH,CACO,wDADP,EAEGC,IAFH,2FAEQ,kBAAOC,QAAP,sIACJR,OAAO,CAACQ,QAAQ,CAACC,IAAV,CAAP,CAEMC,WAHF,CAGgBF,QAAQ,CAACC,IAHzB,CAIJP,EAAE,CAACS,KAAH,CAAS,WAAT,EAEAD,WAAW,CAACE,GAAZ,2FAAgB,iBAAOC,IAAP,iIACdC,OAAO,CAACC,GAAR,CAAYF,IAAI,CAACG,KAAjB,EACMC,UAFQ,CAEK,CACjBC,SAAS,CAAEL,IAAI,CAACK,SADC,CAEjBC,IAAI,CAAEN,IAAI,CAACM,IAFM,CAGjBH,KAAK,CAAEH,IAAI,CAACG,KAHK,CAIjBI,eAAe,CAAEP,IAAI,CAACO,eAJL,CAKjBC,eAAe,CAAER,IAAI,CAACQ,eALL,CAMjBC,WAAW,CAAET,IAAI,CAACS,WAND,CAOjBC,aAAa,CAAEV,IAAI,CAACU,aAPH,CAQjBC,YAAY,CAAEX,IAAI,CAACW,YARF,CASjBC,SAAS,CAAEZ,IAAI,CAACY,SATC,CAUjBC,cAAc,CAAEb,IAAI,CAACa,cAVJ,CAWjBC,aAAa,CAAEd,IAAI,CAACc,aAXH,CAYjBC,aAAa,CAAEf,IAAI,CAACe,aAZH,CAajBC,QAAQ,CAAEhB,IAAI,CAACgB,QAbE,CAcjBC,SAAS,CAAEjB,IAAI,CAACiB,SAdC,CAejBC,SAAS,CAAElB,IAAI,CAACkB,SAfC,CAgBjBC,KAAK,CAAEnB,IAAI,CAACmB,KAhBK,CAFL,uBAqBF9B,CAAAA,EAAE,CAACI,GAAH,CAAO,WAAP,CAAoBO,IAAI,CAACK,SAAzB,CArBE,iDAsBZhB,EAAE,CAAC+B,GAAH,CAAO,WAAP,CAAoBhB,UAApB,EAAgCV,IAAhC,CAAqC,SAAC2B,GAAD,CAAS,CAC5CpB,OAAO,CAACC,GAAR,CAAYmB,GAAZ,EACD,CAFD,EAtBY,sDAAhB,kEANI,wDAFR,iEAoCGC,KApCH,2FAoCS,kBAAOC,GAAP,+HACLtB,OAAO,CAACC,GAAR,CAAYqB,GAAZ,EADK,KAEDA,GAAG,CAACC,OAAJ,EAAe,eAFd,kDAGgBnC,CAAAA,EAAE,CAACoC,MAAH,CAAU,WAAV,CAHhB,QAGG7B,IAHH,gBAIHT,OAAO,CAACS,IAAD,CAAP,CAJG,wDApCT,kEAFqB,wDAAH,kBAAdJ,CAAAA,cAAc,0CAApB,CA8CAA,cAAc,GACf,CAhDQ,CAgDN,EAhDM,CAAT,CAkDA,mBACE,kCACE,KAAC,KAAD,EAAO,IAAI,CAAEN,IAAb,EADF,EADF,CAKD,CAjED,CAmEA,cAAeD,CAAAA,IAAf"},"metadata":{},"sourceType":"module"}